--- a/net/net-tcp-rpc-ext-server.c
+++ b/net/net-tcp-rpc-ext-server.c
@@ -152,7 +152,7 @@
 static int ext_rand_pad_only = 0;
 
 void tcp_rpcs_set_ext_secret (unsigned char secret[16]) {
-  assert (ext_secret_cnt < 16);
+  assert (ext_secret_cnt < 31);
   memcpy (ext_secret[ext_secret_cnt ++], secret, 16);
 }
 

